{"version":3,"sources":["webpack:///./src/pages/news.js","webpack:///./src/utils/truncate.js"],"names":["News","useState","response","setResponse","posts","setPosts","loadMore","setLoadMore","_limit","_start","_sort","params","setParams","getPosts","next","fetch","getPostsUrl","then","data","useEffect","length","pageContext","map","post","i","id","key","imagePath","API_PATH","image","formats","small","url","title","text","description","htmlCaption","words","replace","split","splice","join","date","published_at","cta","src","createSlug","label","slice","styleType","style","textAlign","type","gutter","left","right","top","onClick"],"mappings":"2KAyGeA,UAxFF,WAAO,IAAD,EACeC,mBAAS,IAAlCC,EADU,KACAC,EADA,OAESF,mBAAS,IAA5BG,EAFU,KAEHC,EAFG,OAGeJ,oBAAS,GAAlCK,EAHU,KAGAC,EAHA,OAIWN,mBAAS,CACnCO,OAAQ,EACRC,OAAQ,EACRC,MAAO,sBAHFC,EAJU,KAIFC,EAJE,KAUXC,EAAW,SAACC,GAChBC,YAAMC,YAAYL,EAAQG,IAAOG,MAAK,SAACC,GACrCf,EAAYe,OAkBhB,OAdAC,qBAAU,WACRN,MACC,IAEHM,qBAAU,WACJjB,GAAYA,EAASkB,OAAS,GAChCf,EAAS,GAAD,mBAAKD,GAAL,YAAeF,KACvBU,EAAU,OAAD,UAAMD,EAAN,CAAcF,OAAQE,EAAOF,OAASE,EAAOH,UACtDD,EAAYL,EAASkB,SAAWT,EAAOH,SAEvCD,GAAY,KAEb,CAACL,IAGF,kBAAC,IAAD,CAAQmB,YAAaH,GACnB,kBAAC,IAAD,KAEGd,EAAMkB,KAAI,SAACC,EAAMC,GAChB,GAAU,IAANA,EACF,OACE,kBAAC,IAAD,CACEC,GAAIF,EAAKE,GACTC,IAAQH,EAAKE,GAAV,IAAgBD,EACnBG,UAAS,GAAKC,IAAWL,EAAKM,MAAMC,QAAQC,MAAMC,IAClDC,MAAOV,EAAKU,MACZC,MACEX,EAAKY,aC5DEC,ED4DqBb,EAAKY,YC5DbE,ED4D0B,GC3DxCD,EAAYE,QAAQ,gBAAiB,IACtCC,MAAM,KAAKC,OAAO,EAAGH,GAAOI,KAAK,MD0Dc,IADlD,MAGJC,KAAMnB,EAAKoB,aACXC,IAAK,CACHC,IAAI,SAAUtB,EAAKE,GAAhB,IAAsBqB,YAAWvB,EAAKU,OACzCc,MAAO,sBCjED,IAACX,EAAaC,KDwE9B,kBAAC,IAAD,KACGjC,EAAM4C,MAAM,GAAG1B,KAAI,SAACC,EAAMC,GAAP,OAClB,kBAAC,IAAD,CACEC,GAAIF,EAAKE,GACTC,IAAQH,EAAKE,GAAV,IAAgBD,EACnBG,UAAS,GAAKC,IAAWL,EAAKM,MAAMC,QAAQC,MAAMC,IAClDC,MAAOV,EAAKU,MACZS,KAAMnB,EAAKoB,aACXM,UAAU,OACVL,IAAK,CACHC,IAAI,SAAUtB,EAAKE,GAAhB,IAAsBqB,YAAWvB,EAAKU,cAMhD3B,GACC,yBAAK4C,MAAO,CAAEC,UAAW,WACvB,kBAAC,IAAD,CACEC,KAAK,SACLC,OAAQ,CAAEC,KAAM,OAAQC,MAAO,OAAQC,IAAK,UAC5CC,QAAS,WACP5C,MAJJ,6B","file":"component---src-pages-news-js-a5025cddbbd62596e184.js","sourcesContent":["import React, { useState, useEffect } from 'react';\nimport { fetch, getPostsUrl, createSlug, API_PATH } from '../utils/dao';\nimport { truncate } from '../utils/truncate';\n\n// Components\nimport {\n  Layout,\n  Container,\n  NewsCard,\n  Card,\n  CardGroup,\n  Button,\n} from '../components';\n\n// Data\nimport data from '../data/pages/news.json';\n\nconst News = () => {\n  const [response, setResponse] = useState({});\n  const [posts, setPosts] = useState([]);\n  const [loadMore, setLoadMore] = useState(true);\n  const [params, setParams] = useState({\n    _limit: 4,\n    _start: 0,\n    _sort: 'published_at:desc',\n  });\n\n  const getPosts = (next) => {\n    fetch(getPostsUrl(params, next)).then((data) => {\n      setResponse(data);\n    });\n  };\n\n  useEffect(() => {\n    getPosts();\n  }, []);\n\n  useEffect(() => {\n    if (response && response.length > 0) {\n      setPosts([...posts, ...response]);\n      setParams({ ...params, _start: params._start + params._limit });\n      setLoadMore(response.length === params._limit);\n    } else {\n      setLoadMore(false);\n    }\n  }, [response]);\n\n  return (\n    <Layout pageContext={data}>\n      <Container>\n        {/* Newest Post (Featured post) */}\n        {posts.map((post, i) => {\n          if (i === 0)\n            return (\n              <NewsCard\n                id={post.id}\n                key={`${post.id}-${i}`}\n                imagePath={`${API_PATH}${post.image.formats.small.url}`}\n                title={post.title}\n                text={`${\n                  post.description ? truncate(post.description, 45) : ''\n                }...`}\n                date={post.published_at}\n                cta={{\n                  src: `/post/${post.id}/${createSlug(post.title)}`,\n                  label: 'Continue Reading',\n                }}\n              />\n            );\n        })}\n\n        {/* Cards - All posts other than first post */}\n        <CardGroup>\n          {posts.slice(1).map((post, i) => (\n            <Card\n              id={post.id}\n              key={`${post.id}-${i}`}\n              imagePath={`${API_PATH}${post.image.formats.small.url}`}\n              title={post.title}\n              date={post.published_at}\n              styleType=\"news\"\n              cta={{\n                src: `/post/${post.id}/${createSlug(post.title)}`,\n              }}\n            />\n          ))}\n        </CardGroup>\n\n        {loadMore && (\n          <div style={{ textAlign: 'center' }}>\n            <Button\n              type=\"button\"\n              gutter={{ left: 'auto', right: 'auto', top: '1.5rem' }}\n              onClick={() => {\n                getPosts();\n              }}>\n              Load more news posts\n            </Button>\n          </div>\n        )}\n      </Container>\n    </Layout>\n  );\n};\n\nexport default News;\n","export const truncate = (htmlCaption, words) => {\n  const stringCaption = htmlCaption.replace(/(<([^>]+)>)/gi, '');\n  return stringCaption.split(' ').splice(0, words).join(' ');\n};\n"],"sourceRoot":""}